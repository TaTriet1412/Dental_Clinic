<p>event-dialog works!</p>
<h2 mat-dialog-title>{{ dialogTitle }}</h2>

<mat-dialog-content>
  <form [formGroup]="eventForm" class="event-form" novalidate>

    <!-- Tiêu đề -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Tiêu đề công việc</mat-label>
      <input matInput formControlName="title" required cdkFocusInitial>
      <mat-error *ngIf="eventForm.get('title')?.hasError('required')">
        Tiêu đề là bắt buộc.
      </mat-error>
    </mat-form-field>

    <!-- Nhân viên -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nhân viên</mat-label>
      <mat-select formControlName="resourceId" required>
        <mat-option *ngIf="resources.length === 0" [value]="null" disabled>
          Không có nhân viên
        </mat-option>
        <mat-option *ngFor="let resource of resources" [value]="resource.id">
          {{ resource.title }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="eventForm.get('resourceId')?.hasError('required')">
        Vui lòng chọn nhân viên.
      </mat-error>
    </mat-form-field>

    <!-- All Day Checkbox -->
    <mat-checkbox formControlName="allDay" class="full-width checkbox-margin">
      Sự kiện cả ngày
    </mat-checkbox>

    <!-- Thời gian bắt đầu -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Thời gian bắt đầu</mat-label>
      <input matInput [type]="getDateInputType()" formControlName="start" required>
      <mat-error *ngIf="eventForm.get('start')?.hasError('required')">
        Thời gian bắt đầu là bắt buộc.
      </mat-error>
       <mat-error *ngIf="eventForm.get('start')?.hasError('invalidDate')">
         Ngày giờ bắt đầu không hợp lệ.
       </mat-error>
    </mat-form-field>

    <!-- Thời gian kết thúc -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Thời gian kết thúc</mat-label>
      <!-- [min] không hoạt động tốt với datetime-local, dùng custom validator -->
      <input matInput [type]="getDateInputType()" formControlName="end" required>
      <mat-error *ngIf="eventForm.get('end')?.hasError('required')">
        Thời gian kết thúc là bắt buộc.
      </mat-error>
      <mat-error *ngIf="eventForm.get('end')?.hasError('endDateBeforeStartDateAllDay')">
        Ngày kết thúc phải sau hoặc bằng ngày bắt đầu.
      </mat-error>
      <mat-error *ngIf="eventForm.get('end')?.hasError('endDateMustBeAfterStart')">
        Thời gian kết thúc phải sau thời gian bắt đầu.
      </mat-error>
      <mat-error *ngIf="eventForm.get('end')?.hasError('invalidDate')">
         Ngày giờ kết thúc không hợp lệ.
       </mat-error>
    </mat-form-field>

  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-stroked-button (click)="onCancel()">Hủy bỏ</button>
  <button mat-raised-button color="warn" *ngIf="mode === 'edit' && originalEventData?.id" (click)="onDelete()">
    <mat-icon>delete</mat-icon> Xóa
  </button>
  <!-- Nút Lưu chỉ bật khi form hợp lệ -->
  <button mat-raised-button color="primary" (click)="onSave()" [disabled]="eventForm.invalid">
    <mat-icon>save</mat-icon> {{ mode === 'add' ? 'Thêm mới' : 'Lưu thay đổi' }}
  </button>
</mat-dialog-actions>